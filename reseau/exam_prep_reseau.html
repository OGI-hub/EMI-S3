<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìö Exam R√©seaux - Pr√©paration Intensive</title>
    <style>
        :root {
            --primary: #1e3a5f;
            --accent: #2563eb;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --bg: #0f172a;
            --card: #1e293b;
            --text: #e2e8f0;
            --muted: #94a3b8;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
        }

        .nav {
            background: linear-gradient(135deg, var(--primary), #0f172a);
            padding: 1rem;
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            justify-content: center;
            border-bottom: 2px solid var(--accent);
        }

        .nav button {
            background: transparent;
            border: 2px solid var(--accent);
            color: var(--text);
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
            transition: all 0.3s;
        }

        .nav button:hover,
        .nav button.active {
            background: var(--accent);
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 1.5rem;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.4s;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px)
            }

            to {
                opacity: 1;
                transform: translateY(0)
            }
        }

        h1 {
            text-align: center;
            font-size: 2rem;
            background: linear-gradient(135deg, var(--accent), #10b981);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1.5rem;
        }

        h2 {
            color: var(--accent);
            border-bottom: 2px solid var(--accent);
            padding-bottom: 0.5rem;
            margin: 1.5rem 0 1rem;
        }

        h3 {
            color: #60a5fa;
            margin: 1rem 0 0.5rem;
        }

        .card {
            background: var(--card);
            border-radius: 12px;
            padding: 1.25rem;
            margin: 1rem 0;
            border-left: 4px solid var(--accent);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .reflex {
            border-left-color: var(--success);
        }

        .trap {
            background: linear-gradient(135deg, #3f1e1e, #1e293b);
            border-left-color: var(--danger);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        th,
        td {
            padding: 0.5rem;
            border: 1px solid #334155;
            text-align: left;
        }

        th {
            background: var(--primary);
        }

        .highlight {
            color: var(--warning);
            font-weight: bold;
        }

        ul {
            padding-left: 1.5rem;
        }

        li {
            margin: 0.4rem 0;
        }

        .code-block {
            background: #0f172a;
            border-radius: 8px;
            padding: 1rem;
            font-family: monospace;
            font-size: 0.85rem;
            border: 1px solid #334155;
            margin: 0.5rem 0;
            overflow-x: auto;
        }

        /* Quiz One-Per-Page Style */
        .quiz-container {
            min-height: 60vh;
            display: flex;
            flex-direction: column;
        }

        .quiz-progress {
            background: #334155;
            border-radius: 10px;
            height: 8px;
            margin-bottom: 1.5rem;
            overflow: hidden;
        }

        .quiz-progress-bar {
            background: linear-gradient(90deg, var(--accent), var(--success));
            height: 100%;
            transition: width 0.4s;
        }

        .quiz-header {
            text-align: center;
            margin-bottom: 1rem;
        }

        .quiz-header span {
            background: var(--card);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
        }

        .quiz-question {
            background: var(--card);
            border-radius: 16px;
            padding: 2rem;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .quiz-question h3 {
            font-size: 1.3rem;
            margin-bottom: 1.5rem;
            line-height: 1.5;
        }

        .quiz-options {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
        }

        .quiz-option {
            background: #0f172a;
            padding: 1rem 1.25rem;
            border-radius: 10px;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .quiz-option:hover {
            border-color: var(--accent);
            transform: translateX(5px);
        }

        .quiz-option.selected {
            border-color: var(--accent);
            background: #1e3a5f;
        }

        .quiz-option.correct {
            border-color: var(--success);
            background: #064e3b;
        }

        .quiz-option.incorrect {
            border-color: var(--danger);
            background: #7f1d1d;
        }

        .quiz-option .letter {
            background: var(--accent);
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }

        .quiz-explanation {
            background: #0f172a;
            border-radius: 12px;
            padding: 1.25rem;
            margin-top: 1rem;
            border-left: 4px solid var(--success);
            display: none;
        }

        .quiz-explanation.show {
            display: block;
            animation: fadeIn 0.3s;
        }

        .quiz-explanation h4 {
            color: var(--success);
            margin-bottom: 0.75rem;
        }

        .quiz-explanation .trap-info {
            color: var(--danger);
            margin-top: 0.75rem;
            padding-top: 0.75rem;
            border-top: 1px solid #334155;
        }

        .quiz-concept {
            background: linear-gradient(135deg, #1e3a5f, #1e293b);
            border-radius: 12px;
            padding: 1.25rem;
            margin-top: 1rem;
            border-left: 4px solid var(--warning);
            display: none;
        }

        .quiz-concept.show {
            display: block;
            animation: fadeIn 0.3s;
        }

        .quiz-concept h4 {
            color: var(--warning);
            margin-bottom: 0.75rem;
        }

        .quiz-nav {
            display: flex;
            justify-content: space-between;
            margin-top: 1.5rem;
            gap: 1rem;
        }

        .btn {
            background: var(--accent);
            color: white;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(37, 99, 235, 0.4);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-success {
            background: var(--success);
        }

        .btn-outline {
            background: transparent;
            border: 2px solid var(--accent);
        }

        .score-card {
            background: linear-gradient(135deg, var(--primary), var(--card));
            border-radius: 16px;
            padding: 2rem;
            text-align: center;
        }

        .score-card h2 {
            font-size: 3rem;
            margin: 1rem 0;
        }

        .score-card p {
            color: var(--muted);
        }

        /* Code exercises */
        input.code-input {
            background: #0f172a;
            border: 2px solid var(--accent);
            color: var(--text);
            padding: 0.4rem 0.6rem;
            border-radius: 4px;
            font-family: monospace;
            width: 140px;
        }

        input.code-input.correct {
            border-color: var(--success);
            background: #064e3b;
        }

        input.code-input.incorrect {
            border-color: var(--danger);
            background: #7f1d1d;
        }

        footer {
            text-align: center;
            padding: 1.5rem;
            color: var(--muted);
            border-top: 1px solid #334155;
            margin-top: 2rem;
        }

        footer a {
            color: var(--accent);
            text-decoration: none;
        }
    </style>
</head>

<body>
    <nav class="nav">
        <button class="active" onclick="showSection('synthese')">üìñ Synth√®se</button>
        <button onclick="showSection('qcm-new')">üéØ QCM Compl√©mentaire</button>
        <button onclick="showSection('quiz-saidi')">üìã Quiz Saidi</button>
        <button onclick="showSection('code')">üíª Sockets C</button>
    </nav>

    <div class="container">
        <!-- SYNTH√àSE -->
        <div id="synthese" class="section active">
            <h1>üìö Synth√®se Orient√©e Examen</h1>

            <h2>üîë D√©finitions Cl√©s</h2>
            <div class="card">
                <h3>LAN vs WAN</h3>
                <ul>
                    <li><strong>LAN</strong>: R√©seau Local - Gestion autonome, diffusion, support partag√©</li>
                    <li><strong>WAN</strong>: Liaisons point-√†-point, longues distances</li>
                </ul>
            </div>
            <div class="card">
                <h3>TCP vs UDP</h3>
                <table>
                    <tr>
                        <th>TCP (SOCK_STREAM)</th>
                        <th>UDP (SOCK_DGRAM)</th>
                    </tr>
                    <tr>
                        <td>Connect√©, fiable, ordonn√©</td>
                        <td>Non connect√©, rapide</td>
                    </tr>
                    <tr>
                        <td>HTTP, FTP, Telnet</td>
                        <td>DNS, DHCP, TFTP</td>
                    </tr>
                </table>
            </div>
            <div class="card">
                <h3>Adresse MAC</h3>
                <ul>
                    <li>Taille: <span class="highlight">48 bits = 6 octets</span></li>
                    <li>24 premiers bits = OUI (constructeur)</li>
                    <li>Broadcast = <span class="highlight">FF:FF:FF:FF:FF:FF</span></li>
                </ul>
            </div>
            <div class="card">
                <h3>Classes IP</h3>
                <table>
                    <tr>
                        <th>Classe</th>
                        <th>1er octet</th>
                        <th>H√¥tes/r√©seau</th>
                    </tr>
                    <tr>
                        <td>A</td>
                        <td>1-126</td>
                        <td>16 millions</td>
                    </tr>
                    <tr>
                        <td>B</td>
                        <td>128-191</td>
                        <td>65 534</td>
                    </tr>
                    <tr>
                        <td>C</td>
                        <td>192-223</td>
                        <td>254</td>
                    </tr>
                </table>
            </div>

            <h2>‚ö° R√©flexes Essentiels</h2>
            <div class="card reflex">
                <ul>
                    <li><strong>Hub</strong> ‚Üí L1, ne s√©pare RIEN</li>
                    <li><strong>Switch</strong> ‚Üí L2, s√©pare collisions, PAS broadcast</li>
                    <li><strong>Routeur</strong> ‚Üí L3, s√©pare TOUT</li>
                    <li><strong>accept()</strong> ‚Üí Retourne NOUVEAU socket</li>
                    <li><strong>htons()</strong> ‚Üí Port en Network Byte Order</li>
                    <li><strong>inet_addr()</strong> ‚Üí D√©j√† en Network Order!</li>
                </ul>
            </div>

            <h2>‚ö†Ô∏è Pi√®ges Classiques</h2>
            <div class="card trap">
                <ul>
                    <li><strong>IP non fiable!</strong> TCP assure la fiabilit√©</li>
                    <li><strong>Switch ‚â† s√©pare broadcast</strong> (seul routeur le fait)</li>
                    <li><strong>Trame min Ethernet = 64 octets</strong></li>
                    <li><strong>sin_family en Host Order</strong> (pas transmis)</li>
                    <li><strong>Nb h√¥tes = 2‚Åø - 2</strong> (r√©seau + broadcast)</li>
                </ul>
            </div>

            <h2>üìä S√©quences Sockets</h2>
            <div class="card">
                <p><strong>Serveur TCP:</strong></p>
                <div class="code-block">socket() ‚Üí bind() ‚Üí listen() ‚Üí accept() ‚Üí recv/send ‚Üí close()</div>
                <p><strong>Client TCP:</strong></p>
                <div class="code-block">socket() ‚Üí connect() ‚Üí send/recv ‚Üí close()</div>
                <p><strong>UDP:</strong></p>
                <div class="code-block">socket() ‚Üí [bind()] ‚Üí sendto/recvfrom ‚Üí close()</div>
            </div>
        </div>

        <!-- QCM COMPL√âMENTAIRE -->
        <div id="qcm-new" class="section">
            <h1>üéØ QCM Compl√©mentaire</h1>
            <div class="quiz-container">
                <div class="quiz-progress">
                    <div class="quiz-progress-bar" id="progress-new"></div>
                </div>
                <div class="quiz-header"><span id="quiz-counter-new">Question 1/30</span></div>
                <div id="quiz-content-new" class="quiz-question"></div>
                <div class="quiz-nav">
                    <button class="btn btn-outline" id="prev-new" onclick="prevQuestion('new')">‚Üê Pr√©c√©dent</button>
                    <button class="btn" id="check-new" onclick="checkAnswer('new')">V√©rifier</button>
                    <button class="btn btn-success" id="next-new" onclick="nextQuestion('new')">Suivant ‚Üí</button>
                </div>
            </div>
            <div id="score-new" class="score-card" style="display:none;">
                <p>üéâ Quiz termin√©!</p>
                <h2 id="final-score-new">0/30</h2>
                <button class="btn" onclick="resetQuiz('new')">üîÑ Recommencer</button>
            </div>
        </div>

        <!-- QUIZ SAIDI -->
        <div id="quiz-saidi" class="section">
            <h1>üìã Quiz Saidi (LAN)</h1>
            <p style="text-align:center;color:var(--muted);margin-bottom:1rem;">50 questions - Parties WMN/WiFi exclues
                de l'examen</p>
            <div class="quiz-container">
                <div class="quiz-progress">
                    <div class="quiz-progress-bar" id="progress-saidi"></div>
                </div>
                <div class="quiz-header"><span id="quiz-counter-saidi">Question 1/50</span></div>
                <div id="quiz-content-saidi" class="quiz-question"></div>
                <div class="quiz-nav">
                    <button class="btn btn-outline" id="prev-saidi" onclick="prevQuestion('saidi')">‚Üê Pr√©c√©dent</button>
                    <button class="btn" id="check-saidi" onclick="checkAnswer('saidi')">V√©rifier</button>
                    <button class="btn btn-success" id="next-saidi" onclick="nextQuestion('saidi')">Suivant ‚Üí</button>
                </div>
            </div>
            <div id="score-saidi" class="score-card" style="display:none;">
                <p>üéâ Quiz termin√©!</p>
                <h2 id="final-score-saidi">0/50</h2>
                <button class="btn" onclick="resetQuiz('saidi')">üîÑ Recommencer</button>
            </div>
        </div>

        <!-- CODE SOCKETS -->
        <div id="code" class="section">
            <h1>üíª Ma√Ætrise Sockets C</h1>

            <div class="card">
                <h3>Structures essentielles</h3>
                <div class="code-block">struct sockaddr_in {
                    sin_family; // AF_INET
                    sin_port; // htons(PORT)
                    sin_addr; // INADDR_ANY ou inet_addr("IP")
                    sin_zero[8]; // Padding
                    };</div>
            </div>

            <div class="card">
                <h3>Exercice 1: Serveur TCP (port 8080)</h3>
                <div class="code-block">server_fd = <input type="text" class="code-input" id="c1-1"
                        placeholder="socket(...)">
                    server_addr.sin_family = <input type="text" class="code-input" id="c1-2" placeholder="???">
                    server_addr.sin_port = <input type="text" class="code-input" id="c1-3" placeholder="???">
                    server_addr.sin_addr.s_addr = <input type="text" class="code-input" id="c1-4" placeholder="???">
                    bind(server_fd, ...);
                    <input type="text" class="code-input" id="c1-5" placeholder="???">(server_fd, 5);
                    client_fd = <input type="text" class="code-input" id="c1-6" placeholder="???">(server_fd, ...);
                </div>
                <button class="btn" onclick="checkCode(1)">V√©rifier</button>
                <div id="code-result-1" class="quiz-explanation"></div>
            </div>

            <div class="card">
                <h3>Exercice 2: Client TCP (127.0.0.1:5000)</h3>
                <div class="code-block">sock = socket(<input type="text" class="code-input" id="c2-1"
                        placeholder="???">, SOCK_STREAM, 0);
                    server_addr.sin_port = <input type="text" class="code-input" id="c2-2" placeholder="???">;
                    server_addr.sin_addr.s_addr = <input type="text" class="code-input" id="c2-3" placeholder="???">;
                    <input type="text" class="code-input" id="c2-4" placeholder="???">(sock, &server_addr, ...);
                    n = <input type="text" class="code-input" id="c2-5" placeholder="???">(sock, buffer, ...);
                </div>
                <button class="btn" onclick="checkCode(2)">V√©rifier</button>
                <div id="code-result-2" class="quiz-explanation"></div>
            </div>

            <div class="card">
                <h3>Exercice 3: UDP</h3>
                <div class="code-block">sock = socket(AF_INET, <input type="text" class="code-input" id="c3-1"
                        placeholder="???">, 0);
                    <input type="text" class="code-input" id="c3-2" placeholder="???">(sock, msg, len, 0, &dest,
                    sizeof(dest));
                </div>
                <button class="btn" onclick="checkCode(3)">V√©rifier</button>
                <div id="code-result-3" class="quiz-explanation"></div>
            </div>
        </div>
    </div>

    <footer>
        <p><a href="https://instagram.com/itssamifz" target="_blank">ü¶∏ @itssamifz</a> | ü§≤ ÿßŸÑŸÑŸá Ÿäÿ≥ŸáŸëŸÑ ÿπŸÑŸäÿß ŸàÿπŸÑŸäŸÉŸÖ</p>
    </footer>

    <script>
        // Navigation
        function showSection(id) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav button').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            event.target.classList.add('active');
        }

        // QCM Data
        const qcmNew = [
            { q: "Le protocole IP est:", o: ["Fiable et connect√©", "Non fiable et non connect√©", "Fiable et non connect√©", "Non fiable et connect√©"], c: 1, exp: "IP est 'best effort' - pas de garantie. TCP assure la fiabilit√©.", trap: "C est le pi√®ge! 'Non connect√©' vrai mais 'fiable' FAUX.", concept: "IP = couche 3, routage uniquement. La fiabilit√© est g√©r√©e par TCP (couche 4)." },
            { q: "Le protocole ARP permet de:", o: ["MAC ‚Üí IP", "IP ‚Üí MAC", "Router les paquets", "Attribuer des IP"], c: 1, exp: "ARP = Address Resolution Protocol. Connaissant l'IP, obtenir la MAC.", trap: "A est l'inverse (RARP).", concept: "ARP fonctionne en broadcast: 'Qui a 192.168.1.5?' ‚Üí r√©ponse avec la MAC." },
            { q: "Client DHCP sans IP utilise:", o: ["127.0.0.1", "255.255.255.255", "0.0.0.0", "Son ancienne IP"], c: 2, exp: "0.0.0.0 = 'pas d'adresse' comme source.", trap: "127.0.0.1 est localhost!", concept: "DHCP: DISCOVER(0.0.0.0‚Üí255.255.255.255)‚ÜíOFFER‚ÜíREQUEST‚ÜíACK" },
            { q: "Fragmentation IPv4 se fait:", o: ["√Ä la source uniquement", "Dans le r√©seau, r√©assemblage √† destination", "√Ä destination", "Jamais"], c: 1, exp: "Routeurs IPv4 fragmentent si MTU petit. R√©assemblage √† destination.", trap: "A est vrai pour IPv6!", concept: "IPv6: fragmentation source only. IPv4: n'importe o√π, r√©assemblage destination." },
            { q: "RIP et OSPF sont des protocoles:", o: ["IGP (routage interne)", "EGP (routage externe)", "Transport", "Application"], c: 0, exp: "IGP = Interior Gateway Protocol, utilis√©s DANS un syst√®me autonome.", trap: "BGP est un EGP.", concept: "IGP: RIP, OSPF, EIGRP. EGP: BGP pour inter-AS." },
            { q: "NAT permet de:", o: ["Crypter", "Traduire IP priv√©e ‚Üí publique", "Distribuer IP", "D√©tecter erreurs"], c: 1, exp: "NAT = Network Address Translation. √âconomise les IPv4.", trap: "C = DHCP, A = IPSec.", concept: "Types NAT: statique, dynamique, PAT (plusieurs priv√©es ‚Üí 1 publique avec ports)." },
            { q: "1 carte r√©seau + 5 IP = combien de caches ARP?", o: ["1", "5", "0", "Impossible"], c: 1, exp: "1 cache ARP par adresse IP configur√©e.", trap: "On pourrait penser 1 par carte!", concept: "Chaque IP peut r√©soudre des MAC diff√©rentes sur son r√©seau." },
            { q: "Quelle fonction cr√©e un NOUVEAU socket pour le client?", o: ["bind()", "listen()", "accept()", "connect()"], c: 2, exp: "accept() retourne NOUVEAU socket d√©di√© √† CE client.", trap: "listen() pr√©pare mais ne cr√©e pas.", concept: "Le socket original continue d'√©couter, le nouveau g√®re ce client." },
            { q: "sin_port doit √™tre en:", o: ["Host Byte Order", "Network Byte Order", "Big Endian", "Little Endian"], c: 1, exp: "sin_port transmis sur r√©seau ‚Üí Network Byte Order (htons()).", trap: "sin_family est en Host Order!", concept: "Tout ce qui traverse le r√©seau: Network Order. Local: Host Order." },
            { q: "S√©quence serveur UDP:", o: ["socket‚Üíbind‚Üílisten‚Üíaccept", "socket‚Üíbind‚Üírecvfrom", "socket‚Üíconnect‚Üírecv", "socket‚Üísendto"], c: 1, exp: "UDP: pas de listen/accept! Directement recvfrom/sendto.", trap: "A = TCP serveur.", concept: "UDP connectionless: pas d'√©tablissement de connexion." },
            { q: "inet_addr() retourne:", o: ["Une cha√Æne", "Adresse en Network Order", "Adresse en Host Order", "Un socket"], c: 1, exp: "inet_addr() ‚Üí uint32 D√âJ√Ä en Network Order.", trap: "Pas besoin de htonl() apr√®s!", concept: "inet_ntoa() fait l'inverse: struct in_addr ‚Üí string." },
            { q: "SOCK_STREAM correspond √†:", o: ["UDP", "TCP", "ICMP", "IP brut"], c: 1, exp: "SOCK_STREAM = flux fiable = TCP. SOCK_DGRAM = UDP.", trap: "", concept: "Stream = flot continu et ordonn√©. Datagram = paquets ind√©pendants." },
            { q: "172.x.x.x appartient √† classe:", o: ["A", "B", "C", "D"], c: 1, exp: "Classe B = 128-191. 172 dans cet intervalle.", trap: "172.16-31 sont PRIV√âES.", concept: "Priv√©es: 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16." },
            { q: "Masque /26: combien d'h√¥tes?", o: ["64", "62", "30", "256"], c: 1, exp: "/26 = 6 bits h√¥tes. 2‚Å∂-2 = 62.", trap: "64 oublie -2!", concept: "On retire: adresse r√©seau (tous 0) + broadcast (tous 1)." },
            { q: "192.168.1.255/24 est:", o: ["H√¥te valide", "Broadcast", "Adresse r√©seau", "Multicast"], c: 1, exp: "Bits h√¥te tous √† 1 = broadcast.", trap: ".0 serait l'adresse r√©seau.", concept: "Broadcast: envoie √† toutes les machines du r√©seau." },
            { q: "Root Bridge STP = celui avec:", o: ["Plus grand Bridge ID", "Plus petit Bridge ID", "Plus de ports", "IP la plus basse"], c: 1, exp: "Bridge ID = Priorit√© + MAC. Le PLUS PETIT gagne.", trap: "Priorit√© compar√©e en premier.", concept: "D√©faut priorit√© = 32768. Baisser = meilleure chance root." },
            { q: "Port 'Blocking' STP:", o: ["Transmet", "Apprend MAC", "√âcoute BPDU seulement", "En panne"], c: 2, exp: "Blocking = √©coute BPDU, ni transmit ni apprend.", trap: "Learning apprend mais ne transmet pas.", concept: "√âtats: Blocking‚ÜíListening‚ÜíLearning‚ÜíForwarding." },
            { q: "Temp√™te broadcast caus√©e par:", o: ["Trop DHCP", "Boucle L2 sans STP", "Virus", "Panne routeur"], c: 1, exp: "Sans STP, broadcast tourne ind√©finiment.", trap: "", concept: "STP √©lit root bridge et bloque ports redondants." },
            { q: "FCS utilise:", o: ["Checksum simple", "CRC", "MD5", "Rien"], c: 1, exp: "FCS = CRC-32. D√©tecte erreurs, ne corrige pas.", trap: "D√©tection ‚â† correction!", concept: "CRC = Cyclic Redundancy Check, polynomial math." },
            { q: "Fast Ethernet (100Mbps) port√©e max CSMA/CD:", o: ["2000m", "200m", "100m ou moins", "Illimit√©e"], c: 1, exp: "D√©bit √ó10 ‚Üí temps √∑10 ‚Üí distance √∑10.", trap: "Gigabit utilise full-duplex.", concept: "CSMA/CD n√©cessite d√©tection collision avant fin √©mission." },
            { q: "Cut-Through sur switch:", o: ["V√©rifie CRC", "Transmet d√®s @ destination lue", "Plus lent que Store&Forward", "Filtre erreurs"], c: 1, exp: "Cut-through = rapide mais peut transmettre erreurs.", trap: "Store&Forward v√©rifie CRC.", concept: "Fragment-free: v√©rifie 64 premiers octets (d√©tecte runts)." },
            { q: "Backoff exponentiel apr√®s collision:", o: ["Temps fixe", "Temps al√©atoire, plage double", "Abandon imm√©diat", "Jam signal"], c: 1, exp: "Plage = 0 √† 2^k-1 slots, k = nb collisions.", trap: "Jam signal AVANT backoff.", concept: "Max k=10 pour calcul, abandon apr√®s 16 collisions." },
            { q: "LLC Type 1:", o: ["Connexion + acquittement", "Sans connexion, sans acquittement", "Sans connexion, avec acquittement", "Obsol√®te"], c: 1, exp: "Type 1 le plus utilis√©. Fiabilit√© g√©r√©e par TCP.", trap: "Type 2 = connexion.", concept: "LLC = interface vers couches sup√©rieures, commune √† tous LANs." },
            { q: "192.168.1.0/28, broadcast 2√®me sous-r√©seau:", o: ["192.168.1.15", "192.168.1.31", "192.168.1.16", "192.168.1.30"], c: 1, exp: "/28=16 addr. SR1:.0-.15, SR2:.16-.31. BC=.31", trap: ".30 = derni√®re h√¥te.", concept: "Broadcast = derni√®re adresse du sous-r√©seau." },
            { q: "Max tentatives Ethernet:", o: ["8", "10", "16", "Illimit√©"], c: 2, exp: "16 collisions ‚Üí abandon.", trap: "10 = max pour calcul backoff.", concept: "Apr√®s 16, signale erreur √† couche sup√©rieure." },
            { q: "Transfert fichier TCP utilise:", o: ["sendto/recvfrom", "send/recv ou write/read", "fwrite/fread sur socket", "Impossible"], c: 1, exp: "TCP connect√©: send/recv ou read/write.", trap: "fread/fwrite = fichiers locaux.", concept: "sendto/recvfrom pour UDP (sp√©cifie destination)." },
            { q: "gethostbyname():", o: ["Nom ‚Üí IP", "IP ‚Üí Nom", "Cr√©e socket", "Configure DNS"], c: 0, exp: "DNS lookup: nom domaine ‚Üí adresse IP.", trap: "gethostbyaddr() = inverse.", concept: "Retourne struct hostent avec liste d'adresses." },
            { q: "Serveur concurrent fork(): le fils:", o: ["Garde 2 sockets", "Ferme √©coute, garde client", "Garde 2 sockets", "Partage sockets"], c: 1, exp: "Fils traite client, parent continue √©couter.", trap: "Descripteurs copi√©s au fork.", concept: "Chacun ferme ceux qu'il n'utilise pas." },
            { q: "Trame Ethernet taille min:", o: ["46 octets", "64 octets", "512 octets", "1518 octets"], c: 1, exp: "64 octets min (avec padding si donn√©es < 46).", trap: "46 = donn√©es min.", concept: "Pour garantir d√©tection collision sur 2000m √† 10Mbps." },
            { q: "select() permet de:", o: ["Bloquer ind√©finiment", "Surveiller plusieurs sockets", "Cr√©er socket", "Fermer connexion"], c: 1, exp: "Multiplexage I/O: attendre sur plusieurs fd.", trap: "", concept: "√âvite threads multiples. Param√®tre timeout optionnel." }
        ];

        const quizSaidi = [
            { q: "Port√©e typique d'un LAN:", o: ["Quelques m√®tres (Bluetooth)", "Quelques km m√™me organisation", "Une ville enti√®re", "Distance illimit√©e via Internet"], c: 1, exp: "LAN = Local Area Network, limit√© g√©ographiquement.", concept: "LAN: gestion autonome, haut d√©bit, faible latence." },
            { q: "Caract√©ristique distinguant LAN de WAN:", o: ["Transmission bande de base", "Gestion autonome", "Support partag√©", "Toutes les r√©ponses"], c: 3, exp: "LAN: bande de base, priv√©, diffusion.", concept: "WAN: point-√†-point, g√©r√© par op√©rateur, modulation." },
            { q: "Sous-couche commune √† tous les LANs:", o: ["MAC", "LLC (802.2)", "IP", "Physique"], c: 1, exp: "LLC = interface commune vers couches sup√©rieures.", concept: "MAC varie selon techno (Ethernet, Token Ring...)." },
            { q: "R√¥le principal sous-couche MAC:", o: ["Contr√¥le flux bout en bout", "Acc√®s support et conflits", "Routage paquets", "Cryptage"], c: 1, exp: "MAC = Medium Access Control.", concept: "G√®re qui parle quand sur le support partag√©." },
            { q: "Norme IEEE WiFi:", o: ["802.3", "802.5", "802.11", "802.16"], c: 2, exp: "802.11 = WiFi. 802.3 = Ethernet.", concept: "802.5 = Token Ring, 802.16 = WiMAX." },
            { q: "Panne point central paralyse r√©seau:", o: ["Bus", "Anneau", "√âtoile", "Maill√©e"], c: 2, exp: "√âtoile: tout passe par le centre.", concept: "Bus: panne terminaison. Anneau: rupture c√¢ble." },
            { q: "Avantage topologie bus:", o: ["Maintenance facile", "C√¢blage √©conomique", "Performance sous charge", "Immunit√© pannes c√¢bles"], c: 1, exp: "Bus = c√¢ble unique, simple.", concept: "Inconv√©nient: collision, diagnostic difficile." },
            { q: "C√¢ble 10 Gbps:", o: ["Cat 5", "Cat 5e", "Cat 7", "Cat 3"], c: 2, exp: "Cat 7 = 10Gbps. Cat 5e = Gigabit.", concept: "Cat 8 = 25/40 Gbps." },
            { q: "Distance max segment UTP:", o: ["10m", "100m", "500m", "2km"], c: 1, exp: "100m pour toutes les vitesses UTP.", concept: "Au-del√†: r√©p√©teur ou fibre." },
            { q: "Fibre longues distances (m√©tropolitain):", o: ["Multimode", "Monomode", "Coaxiale", "STP"], c: 1, exp: "Monomode = un seul mode de propagation, moins dispersion.", concept: "Multimode = courtes distances, moins cher." },
            { q: "C√¢ble PC √† PC direct:", o: ["Droit", "Crois√©", "Console", "Fibre"], c: 1, exp: "Crois√©: TX‚ÜîRX invers√©.", concept: "Droit: PC-Switch. Crois√©: PC-PC, Switch-Switch." },
            { q: "Terminaisons aux extr√©mit√©s bus:", o: ["Amplifier signal", "Absorber signal (√©viter √©chos)", "Connecter nouvelles stations", "Alimenter c√¢ble"], c: 1, exp: "Terminaison = imp√©dance adapt√©e.", concept: "Sans terminaison: r√©flexions = erreurs." },
            { q: "Collision dans un r√©seau:", o: ["Panne logicielle", "Deux signaux interf√®rent", "C√¢ble coup√©", "Erreur mot de passe"], c: 1, exp: "Collision = superposition signaux.", concept: "Domaine de collision = zone o√π √ßa peut arriver." },
            { q: "M√©thode d'acc√®s d√©terministe:", o: ["CSMA/CD", "ALOHA", "Passage jeton", "CSMA/CA"], c: 2, exp: "Jeton = temps acc√®s garanti.", concept: "D√©terministe = pr√©dictible. CSMA = al√©atoire." },
            { q: "Roll-Call Polling:", o: ["Stations passent jeton", "Ma√Ætre interroge chaque esclave", "√âmission d√®s donn√©es", "Backoff collisions"], c: 1, exp: "Polling centralis√©.", concept: "Efficace mais point central = SPOF." },
            { q: "Token Ring: station re√ßoit trame non destin√©e:", o: ["D√©truit", "R√©g√©n√®re et transmet", "Stocke", "Renvoie √©metteur"], c: 1, exp: "Chaque station r√©g√©n√®re le signal.", concept: "Anneau actif, pas passif." },
            { q: "CSMA/CD signifie:", o: ["Control System Medium Access", "Carrier Sense Multiple Access/Collision Detection", "Computer Sense Main Access", "Cable Signal Multi Access"], c: 1, exp: "√âcoute porteuse, acc√®s multiple, d√©tection collision.", concept: "CD = Detection. CA (WiFi) = Avoidance." },
            { q: "Inconv√©nient CSMA/CD:", o: ["Complexe installer", "Serveur puissant requis", "Pas de garantie temps acc√®s", "Impossible fibre"], c: 2, exp: "Non d√©terministe.", concept: "Collisions ‚Üí d√©lais impr√©visibles." },
            { q: "Longueur adresse MAC:", o: ["32 bits", "48 bits", "64 bits", "128 bits"], c: 1, exp: "48 bits = 6 octets.", concept: "IPv4 = 32 bits, IPv6 = 128 bits." },
            { q: "24 premiers bits adresse MAC:", o: ["Num√©ro s√©rie carte", "Adresse IP r√©seau", "OUI (constructeur)", "Protocole utilis√©"], c: 2, exp: "OUI = Organizationally Unique Identifier.", concept: "Attribu√© par IEEE." },
            { q: "Adresse MAC Broadcast:", o: ["00:00:00:00:00:00", "01:00:5E:00:00:00", "FF:FF:FF:FF:FF:FF", "127.0.0.1"], c: 2, exp: "Tous les bits √† 1.", concept: "01:00:5E = pr√©fixe multicast." },
            { q: "Premier octet 08 = type adresse:", o: ["Unicast Universelle", "Multicast", "Broadcast", "Locale"], c: 0, exp: "08 en binaire = ...0 (bit pair) = unicast.", concept: "Bit 0 du 1er octet: 0=unicast, 1=multicast." },
            { q: "Adresse MAC appartient couche:", o: ["1 Physique", "2 Liaison", "3 R√©seau", "4 Transport"], c: 1, exp: "MAC = sous-couche de Liaison.", concept: "IP = couche 3, port TCP/UDP = couche 4." },
            { q: "Service LLC le plus utilis√© (r√©seaux IP):", o: ["Type 1 (sans connexion, sans ACK)", "Type 2 (connexion, ACK)", "Type 3 (sans connexion, ACK)", "Aucun"], c: 0, exp: "Type 1: simple, fiabilit√© par TCP.", concept: "Type 2 peu utilis√©, redondant avec TCP." },
            { q: "Primitive LLC r√©ception donn√©es:", o: ["L_DATA.request", "L_DATA.indication", "L_CONNECT", "L_RESET"], c: 1, exp: "indication = notification vers couche sup√©rieure.", concept: "request = demande vers couche inf√©rieure." },
            { q: "Taille min trame Ethernet (@ dest au FCS):", o: ["46 octets", "64 octets", "512 octets", "1518 octets"], c: 1, exp: "64 octets minimum.", concept: "1518 max (sans VLAN tag)." },
            { q: "Pourquoi taille min trame n√©cessaire:", o: ["√âconomiser bande passante", "D√©tecter collision avant fin √©mission", "Permettre cryptage", "Satisfaire IP"], c: 1, exp: "Temps propagation A/R.", concept: "Sur 2km √† 10Mbps, besoin 64 octets." },
            { q: "Jam Signal:", o: ["Signal demande d√©bit", "32 bits apr√®s collision", "Musique attente", "Signal fin transmission"], c: 1, exp: "Jam = brouillage, alerter toutes stations.", concept: "Apr√®s jam, backoff al√©atoire." },
            { q: "Algorithme temps attente apr√®s collision:", o: ["Dijkstra", "Backoff Exponentiel Binaire", "Spanning Tree", "Round Robin"], c: 1, exp: "BEB: temps cro√Æt exponentiellement.", concept: "0 √† 2^k-1 slots, k = nb collisions (max 10)." },
            { q: "Tentatives max avant abandon Ethernet:", o: ["1", "8", "16", "Illimit√©"], c: 2, exp: "16 collisions = abandon.", concept: "Signale erreur √† LLC." },
            { q: "Fast Ethernet d√©bit √ó10, port√©e CSMA/CD:", o: ["√ó10", "Identique", "√∑10", "1 m√®tre"], c: 2, exp: "Temps bit √∑10 ‚Üí distance √∑10.", concept: "Pourquoi Gigabit = full-duplex." },
            { q: "FCS sert √†:", o: ["Identifier source", "D√©tecter erreurs (CRC)", "Priorit√© trame", "Synchroniser horloges"], c: 1, exp: "FCS = Frame Check Sequence.", concept: "CRC d√©tecte, ne corrige pas." },
            { q: "Hub op√®re couche:", o: ["1 Physique", "2 Liaison", "3 R√©seau", "7 Application"], c: 0, exp: "Hub = r√©p√©teur multiport.", concept: "R√©p√®te bits, ne comprend pas trames." },
            { q: "Diff√©rence Hub vs Switch:", o: ["Hub plus rapide", "Switch = bande passante d√©di√©e par port", "Hub utilise IP", "Aucune"], c: 1, exp: "Switch: pas de collision entre ports.", concept: "Switch = pont multiport intelligent." },
            { q: "Domaine de collision:", o: ["Machines recevant broadcast", "Zone o√π trames peuvent interf√©rer", "Logiciel piratage", "Table MAC switch"], c: 1, exp: "Tout √©quipement sur m√™me segment.", concept: "Hub = 1 domaine. Switch = 1 par port." },
            { q: "√âquipement segmente domaines broadcast:", o: ["Hub", "Switch", "Routeur", "R√©p√©teur"], c: 2, exp: "Routeur = fronti√®re r√©seau.", concept: "VLAN aussi, mais niveau logique." },
            { q: "Switch apprend adresses MAC:", o: ["Saisie manuelle", "Lecture @ source trames re√ßues", "Serveur DNS", "Interroge routeur"], c: 1, exp: "Apprentissage automatique.", concept: "Table MAC-port, timeout ~5min." },
            { q: "Cut-Through switching:", o: ["Attend fin trame", "Commute d√®s @ destination lue", "V√©rifie erreurs avant envoi", "Coupe c√¢bles inutiles"], c: 1, exp: "Tr√®s faible latence.", concept: "Inconv√©nient: peut transmettre erreurs." },
            { q: "Inconv√©nient Store-and-Forward:", o: ["Transmet erreurs", "Latence prop. taille trame", "Incompatible fibre", "Fonctionne qu'avec Hubs"], c: 1, exp: "Attend trame compl√®te + v√©rifie CRC.", concept: "Plus fiable, plus lent." },
            { q: "STP r√©sout:", o: ["Manque IP", "Boucles niveau 2", "Pannes courant", "Lenteur Internet"], c: 1, exp: "Spanning Tree Protocol.", concept: "√âlit root bridge, bloque ports redondants." },
            { q: "Temp√™te de broadcast:", o: ["Orage perturbe WiFi", "Trame diffus√©e ind√©finiment par boucle", "Mise √† jour Windows", "Trop emails"], c: 1, exp: "Boucle sans STP.", concept: "Sature r√©seau en secondes." },
            { q: "Root Bridge √©lu:", o: ["Plus cher", "Plus faible Bridge ID", "Connect√© routeur", "Hasard"], c: 1, exp: "Bridge ID = priorit√© + MAC.", concept: "Plus petit gagne." },
            { q: "Port STP pour briser boucle:", o: ["Forwarding", "Listening", "Blocking", "Learning"], c: 2, exp: "Blocking = pas de transmission.", concept: "√âcoute BPDU seulement." },
            { q: "Messages STP:", o: ["IP Packet", "BPDU", "Hello World", "ARP Request"], c: 1, exp: "Bridge Protocol Data Unit.", concept: "Contient root ID, co√ªt, port ID." },
            { q: "Routeur base d√©cisions sur:", o: ["Adresse MAC", "Adresse L3 (IP)", "Port physique", "Nom utilisateur"], c: 1, exp: "Routage = couche 3.", concept: "Examine en-t√™te IP, consulte table routage." },
            { q: "Adage switching vs routing:", o: ["Route when can, switch when must", "Switch when can, route when must", "Always route", "Hub when can"], c: 1, exp: "Switch = rapide, route = n√©cessaire.", concept: "Switch local, route inter-r√©seaux." },
            { q: "Passerelle niveau 7:", o: ["Amplifie WiFi", "Convertit protocoles applicatifs", "Connecte c√¢bles Ethernet", "Bloque virus"], c: 1, exp: "Gateway applicative.", concept: "Ex: SMTP ‚Üî X.400." },
            { q: "√âquipement plus 'intelligent':", o: ["Hub", "Pont", "Routeur", "R√©p√©teur"], c: 2, exp: "Routeur comprend L3.", concept: "Intelligence croissante: r√©p√©teur<hub<pont<switch<routeur<gateway." },
            { q: "Architecture Client-Serveur, inconv√©nient serveur:", o: ["Trop lent", "Point de d√©faillance unique", "Pas stockage fichiers", "WiFi obligatoire"], c: 1, exp: "SPOF = Single Point Of Failure.", concept: "Solution: redondance, clustering." },
            { q: "Pr√©c√¢blage structur√©:", o: ["C√¢bles au fur et √† mesure", "Installation normalis√©e, souple, √©volutive", "Uniquement fibre", "Supprime switchs"], c: 1, exp: "Norme: topologie √©toile, baies centrales.", concept: "Facilite changements, maintenance." }
        ];

        // Quiz state
        const quizState = {
            new: { current: 0, answers: [], checked: [], score: 0 },
            saidi: { current: 0, answers: [], checked: [], score: 0 }
        };

        function getQuestions(type) { return type === 'new' ? qcmNew : quizSaidi; }

        function renderQuestion(type) {
            const state = quizState[type];
            const questions = getQuestions(type);
            const q = questions[state.current];
            const total = questions.length;

            document.getElementById(`progress-${type}`).style.width = ((state.current + 1) / total * 100) + '%';
            document.getElementById(`quiz-counter-${type}`).textContent = `Question ${state.current + 1}/${total}`;

            const checked = state.checked[state.current];
            const selected = state.answers[state.current];

            let optionsHTML = q.o.map((opt, i) => {
                let cls = 'quiz-option';
                if (selected === i) cls += ' selected';
                if (checked && i === q.c) cls += ' correct';
                if (checked && selected === i && i !== q.c) cls += ' incorrect';
                return `<div class="${cls}" onclick="selectAnswer('${type}',${i})" data-i="${i}">
            <span class="letter">${String.fromCharCode(65 + i)}</span>
            <span>${opt}</span>
        </div>`;
            }).join('');

            let expHTML = checked ? `<div class="quiz-explanation show">
        <h4>‚úÖ R√©ponse: ${String.fromCharCode(65 + q.c)}) ${q.o[q.c]}</h4>
        <p>${q.exp}</p>
        ${q.trap ? `<p class="trap-info">‚ö†Ô∏è Pi√®ge: ${q.trap}</p>` : ''}
    </div>` : '';

            let conceptHTML = checked && q.concept ? `<div class="quiz-concept show">
        <h4>üìö Concept du cours</h4>
        <p>${q.concept}</p>
    </div>` : '';

            document.getElementById(`quiz-content-${type}`).innerHTML = `
        <h3>${state.current + 1}. ${q.q}</h3>
        <div class="quiz-options">${optionsHTML}</div>
        ${expHTML}${conceptHTML}
    `;

            document.getElementById(`prev-${type}`).disabled = state.current === 0;
            document.getElementById(`check-${type}`).disabled = checked || selected === undefined;
            document.getElementById(`next-${type}`).textContent = state.current === total - 1 ? 'Terminer' : 'Suivant ‚Üí';
        }

        function selectAnswer(type, i) {
            if (quizState[type].checked[quizState[type].current]) return;
            quizState[type].answers[quizState[type].current] = i;
            renderQuestion(type);
        }

        function checkAnswer(type) {
            const state = quizState[type];
            const q = getQuestions(type)[state.current];
            state.checked[state.current] = true;
            if (state.answers[state.current] === q.c) state.score++;
            renderQuestion(type);
        }

        function nextQuestion(type) {
            const state = quizState[type];
            const total = getQuestions(type).length;
            if (state.current < total - 1) {
                state.current++;
                renderQuestion(type);
            } else {
                document.querySelector(`#${type === 'new' ? 'qcm-new' : 'quiz-saidi'} .quiz-container`).style.display = 'none';
                document.getElementById(`score-${type}`).style.display = 'block';
                document.getElementById(`final-score-${type}`).textContent = `${state.score}/${total}`;
            }
        }

        function prevQuestion(type) {
            if (quizState[type].current > 0) {
                quizState[type].current--;
                renderQuestion(type);
            }
        }

        function resetQuiz(type) {
            const total = getQuestions(type).length;
            quizState[type] = { current: 0, answers: [], checked: [], score: 0 };
            document.querySelector(`#${type === 'new' ? 'qcm-new' : 'quiz-saidi'} .quiz-container`).style.display = 'flex';
            document.getElementById(`score-${type}`).style.display = 'none';
            renderQuestion(type);
        }

        // Code exercises
        function checkCode(n) {
            const answers = {
                1: {
                    'c1-1': ['socket(AF_INET,SOCK_STREAM,0)', 'socket(AF_INET, SOCK_STREAM, 0)'],
                    'c1-2': ['AF_INET'],
                    'c1-3': ['htons(8080)'],
                    'c1-4': ['INADDR_ANY', 'htonl(INADDR_ANY)'],
                    'c1-5': ['listen'],
                    'c1-6': ['accept']
                },
                2: {
                    'c2-1': ['AF_INET'],
                    'c2-2': ['htons(5000)'],
                    'c2-3': ['inet_addr("127.0.0.1")', 'inet_addr(\'127.0.0.1\')'],
                    'c2-4': ['connect'],
                    'c2-5': ['recv']
                },
                3: {
                    'c3-1': ['SOCK_DGRAM'],
                    'c3-2': ['sendto']
                }
            };

            let allOk = true;
            for (const [id, valid] of Object.entries(answers[n])) {
                const el = document.getElementById(id);
                const val = el.value.trim().replace(/\s+/g, '');
                const ok = valid.some(v => val.toLowerCase() === v.toLowerCase().replace(/\s+/g, ''));
                el.classList.remove('correct', 'incorrect');
                el.classList.add(ok ? 'correct' : 'incorrect');
                if (!ok) allOk = false;
            }

            const res = document.getElementById(`code-result-${n}`);
            res.classList.add('show');
            res.innerHTML = allOk
                ? '<span style="color:var(--success)">‚úÖ Parfait!</span>'
                : '<span style="color:var(--warning)">üìù V√©rifiez les champs en rouge</span>';
        }

        // Init
        document.addEventListener('DOMContentLoaded', () => {
            renderQuestion('new');
            renderQuestion('saidi');
        });
    </script>
</body>

</html>